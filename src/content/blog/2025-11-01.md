---
title: University... H4CK3D!
description: Hackeo una famosa universidad sin querer - XSS y descarga de archivos expuestos desde el servidor
date: 2025-11-01
categories: [Hacking]
author: N0M4D
tags: [hacking, script, terminal, python, xss, security]
hideToc: true
---

Jamás me había parado a mirar las tripas de la web, pero desde que curro en CODERE me he vuelto más diablo. Es inverosímil la cantidad de vulnerabilidades que puedes encontrar si sabes dónde mirar. Incluso cosas “muertas” como una XSS (inyección de JS; la clásica) siguen vivitas y coleando.

Hace un mes empecé un máster en cierta universidad online famosilla, especializada en finanzas y economía. Universidad de nueva creación. Esperaba software moderno y fino. Y lo era… **pura fachada.** Le pegas con un palo y salen vulnerabilidades como cucarachas. Sin ser pentester, <b>no tuve que esforzarme para romper su seguridad dos veces.</b> Aquí va el relato.

---

## <!> XSS Injection

La página tiene un apartado de perfil. Como en todo buen _“User Settings”_, hay formulario. Los formularios suelen venir protegidos por los frameworks de serie. <b>Spoiler: no aquí.</b>

Había un campo “Biografía”: texto libre, sin límite de caracteres, sin dar formato. Ni siquiera podía separar párrafos. Probé con `\n\n`: nada. Pensé: _igual interpreta HTML._ Probé con `<br/>` y funcionó. Fui feliz un rato.

Quise más. Probé a envolver párrafos con `<p></p>` y meter `style="color: red"`. También funcionó. Y no solo eso: vi que aceptaba `<style></style>`.

<div style="display:flex;">
    <img style='object-position: 0px -0px;object-fit: none;height:20rem;width:20rem;margin: 0 auto; border: 1px solid black; border-radius: 25px;' src='/images/blog/uni-hacked/1.png' alt='form example - styles injection'/>
    <img style='object-position: 0px -140px;object-fit: none;height:20rem;width:20rem;margin: 0 auto; border: 1px solid black; border-radius: 25px;' src='/images/blog/uni-hacked/2.png' alt='form example - xss injection'/>
</div>

Llegados a este punto la pregunta era obligada: _si se come `<style>`, ¿también `<script>`?_ <br/>
Ya sabéis la respuesta: <b>Sí, pude ejecutar JS en el cliente.</b> Y si otro usuario visitaba mi perfil, también ejecutaba mi JS en su navegador. Delicia.

<div style="display:flex;align-items:center;gap:1rem;padding-inline:10%;">
    <span>
        <p>La página está llena de logs y comentarios, pero hagamos como que no los hemos visto ...</p>
        <p>Inspeccionando el DOM, el cuadro de texto inyectaba sin pudor todo lo que venía. Y en base de datos, guardado tal cual, ni sanitizado ni leches. Ahora me pregunto si podría atacar el server, porque eso ya sería la h*stia.</p>
    </span>
    <img style='height:20rem;margin: 0 auto; border: 1px solid black; border-radius: 25px; margin-top:1rem;' src='/images/blog/uni-hacked/3.png' alt='xss injection - term'/>
</div>

#### Resumen del bug

- Campo de texto rico <b>sin sanitización</b> ni whitelist de etiquetas.
- Permite HTML crudo, atributos `style y script`.
- Ejecución en el navegador de terceros al visitar perfiles → <b>XSS Almacenada</b>

#### Impacto potencial

- <b>Robo de sesiones y datos de compañeros.</b>
- Keylogging, CSRF, falsificación de vistas, phishing interno.
- Pivot a otros subdominios si comparten cookies o sesión. Divertido, ¿eh?

---

## <!> Batch Bunny

En el curso, a veces hay que **repasar clases.** Sería genial descargar vídeos o al menos **escucharlos como podcast.** Lástima que no ofrecen esa opción… ¿verdad?

Clic derecho bloqueado, pero la inspección del DOM es libre. Los vídeos están en un **iframe dentro de otro iframe**, servidos por <b>Bunny</b> ( supongo que [bunny.net](https://bunny.net/)).

Intenté descargar: `curl`, script en Python… <b>403 Forbidden a saco.</b> No eran credenciales: **faltaban cabeceras.** Añadí las cabeceras adecuadas y pude bajar el HTML del iframe. Desde ahí, encontrar los vídeos era trivial.

Le metí extras al script:

- **Descarga múltiple** leyendo un fichero con iframes.
- **Extractor de audio** (alias Podcastify) para llevarme las clases en el gym.
- Pipeline “pásame iframes → me bajo el curso”.

<b>Literalmente puedo bajarme todo.</b>

<img style='margin: 0 auto; border: 1px solid black; border-radius: 25px; margin-top:1rem;' src='/images/blog/uni-hacked/4.png' alt='xss injection - term'/>

> #### Nota técnica breve
>
> Los CDN/players suelen validar origin, referer y user-agent; si los replicas y resuelves las playlists M3U8, la descarga cae sola.

## <!> Xplo!t

Tranquilos. No exploté todo… **solo lo de los vídeos para uso personal.** Antes avisé al soporte para contarles las vulnerabilidades. La XSS me parecía más crítica: lo de bajar vídeos es feo para negocio, pero **una XSS almacenada es robar datos, mover dinero ajeno y cosas peores.**

El <b>magnífico</b> equipo de la uni no respondió. Insistí. A la segunda: _“Lo transmitiremos, gracias por tu sinceridad”_. Ha pasado un mes y todo sigue igual. Tampoco pidieron pasos para reproducir ni cómo arreglarlo. Flojito.

> #### Fixes propuestos
>
> <b>Sanitización/escape estricto:</b> permitir solo texto o una whitelist cerrada (Markdown con renderer seguro, por ejemplo).<br/>
> <b>CSP decente:</b> sin unsafe-inline, sin unsafe-eval, con script-src y style-src bien cerrados.<br/>
> <b>HTTP-only/SameSite</b> para cookies, y aislamiento de dominios si comparten sesión.<br/>
> <b>Revisar el player/CDN:</b> exigir tokens temporales y firmados, hotlink protection real y verificación de origen consistente.<br/>
> <b>Bug bounty</b> o al menos canal de seguridad que responda algo más que _"lo pasamos"_.<br/>

> #### Epílogo
>
> Seguiré un poco más, a ver hasta dónde llego. No por maldad; por **higiene digital.** <b>Si tu fachada es _"premium"_, que tus cimientos no sean de cartón.</b>
